<div class="campaign-panel-inner p-5 sm:p-6 border-2 border-green-500/30 bg-green-500/10 rounded-xl">
  <div class="flex items-start gap-4">
    <%= icon :circle_check, size: 28, class_name: "text-green-600 flex-shrink-0 mt-0.5" %>
    <div class="flex-1 min-w-0">
      <p class="campaign-font text-xl sm:text-2xl font-black text-green-600 mb-2">
        Poster<%= poster_group.poster_count == 1 ? '' : 's' %> Generated!
      </p>
      <p class="text-sm sm:text-base campaign-text-secondary mb-4 leading-relaxed">
        <% if poster_group.name.present? %>
          <% if poster_group.poster_count == 1 %>
            "<%= poster_group.name %>" is ready with a unique QR code and referral link.
          <% else %>
            Group "<%= poster_group.name %>" created with <%= poster_group.poster_count %> unique posters.
          <% end %>
        <% else %>
          <% if poster_group.poster_count == 1 %>
            Your poster is ready with a unique QR code and referral link.
          <% else %>
            Your <%= poster_group.poster_count %> posters are ready, each with a unique QR code.
          <% end %>
        <% end %>
        <% if defined?(unpaid_count) && unpaid_count.to_i > 0 %>
          <br><span class="text-amber-600 font-semibold">Note: <%= unpaid_count %> poster<%= unpaid_count == 1 ? '' : 's' %> won't earn shards (quota exceeded).</span>
        <% end %>
      </p>
      
      <div class="space-y-3">
        <% if poster_group.poster_count > 1 %>
          <div class="relative" data-controller="dropdown" x-data="{ open: false }">
            <button type="button" 
                    data-action="click->dropdown#toggle"
                    onclick="const menu = this.nextElementSibling; menu.classList.toggle('hidden'); event.stopPropagation();"
                    class="campaign-btn campaign-btn--primary w-full justify-center text-base">
              <%= icon :download, size: 20 %>
              Download Posters
              <%= icon :chevron_down, size: 16, class_name: "ml-1" %>
            </button>
            <div data-dropdown-target="menu" 
                 class="hidden absolute top-full left-0 right-0 mt-1 rounded-lg campaign-surface border-2 border-current/20 shadow-lg overflow-hidden z-10">
              <%= link_to download_all_poster_group_path(poster_group), 
                  class: "flex items-center gap-2 px-4 py-2.5 text-sm font-bold campaign-text-primary hover:bg-black/5 transition-colors" do %>
                <%= icon :file, size: 16 %>
                Download Posters (merged)
              <% end %>
              <%= link_to download_all_poster_group_path(poster_group, format: :zip), 
                  class: "flex items-center gap-2 px-4 py-2.5 text-sm font-bold campaign-text-primary hover:bg-black/5 transition-colors border-t border-current/10" do %>
                <%= icon :archive, size: 16 %>
                Download Posters (zip)
              <% end %>
            </div>
          </div>
        <% end %>

        <% if poster_group.poster_count == 1 %>
          <% poster = poster_group.posters.first %>
          <%= link_to download_poster_path(poster), class: "campaign-btn campaign-btn--primary w-full justify-center text-base" do %>
            <%= icon :download, size: 20 %>
            Download Poster
          <% end %>
        <% end %>

        <%= link_to poster_group_path(poster_group), class: "campaign-btn campaign-btn--secondary w-full justify-center text-sm" do %>
          <%= icon :settings, size: 18 %>
          Manage Poster<%= poster_group.poster_count == 1 ? '' : 's' %>
        <% end %>

        <p class="text-xs campaign-text-muted text-center leading-relaxed">
          Print, put up, then upload proof from the manage page to earn shards.
        </p>
      </div>
    </div>
  </div>
</div>

<script>
  // Hide the form after successful poster generation
  const form = document.querySelector('[data-poster-modal-target="form"]');
  if (form) {
    form.style.display = 'none';
  }
</script>
